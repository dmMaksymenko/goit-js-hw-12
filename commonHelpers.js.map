{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["('use strict');\nimport axios from 'axios';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  const searchForm = document.querySelector('.search-form');\n  const galleryMarkup = document.querySelector('.gallery');\n  const submitBtn = document.querySelector('.search-btn');\n  const loader = document.querySelector('.loader');\n  const GALLERY_LINK = 'gallery-link';\n  const loadMoreBtn = document.querySelector('.load-more-btn');\n  let gallery;\n  submitBtn.disabled = true;\n  let page = 1;\n  let query = null;\n  let totalResult = 0;\n\n  searchForm.elements.query.addEventListener('input', function () {\n    query = this.value.trim();\n    submitBtn.disabled = query === '';\n  });\n\n  searchForm.addEventListener('submit', async function (e) {\n    e.preventDefault();\n    const query = e.target.elements.query.value.trim();\n    if (query === '') {\n      return;\n    }\n    try {\n      const data = await getImage(query, 1);\n      loader.style.display = 'none';\n      renderImgs(data.hits);\n      submitBtn.disabled = true;\n      totalResult = data.total;\n      checkBtnStatus();\n\n      gallery = new SimpleLightbox(`.${GALLERY_LINK}`, {\n        captionsData: 'alt',\n        captionDelay: 250,\n      });\n      gallery.refresh();\n      gallery.on('show.simplelightbox');\n    } catch (error) {\n      loader.style.display = 'none';\n      onError(`Error fetching images: ${error}`);\n    } finally {\n      e.target.elements.query.value = '';\n    }\n  });\n  async function getImage(query, page = 1) {\n    const BASE_URL = 'https://pixabay.com/api/';\n\n    const searchParams = new URLSearchParams({\n      key: '42137546-386b5be41212ccd429cab5a80',\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safeSearch: true,\n      per_page: 15,\n      page: page,\n    });\n    const Params = `?${searchParams}`;\n    const url = BASE_URL + Params;\n\n    try {\n      const response = await axios.get(url);\n      if (!response.data) {\n        throw new Error('No data returned from the API');\n      }\n      return response.data;\n    } catch (error) {\n      throw new Error(`Error fetching images: ${error.message}`);\n    }\n  }\n\n  function checkBtnStatus() {\n    if (totalResult === 0) {\n      loadMoreBtn.style.display = 'none';\n      return;\n    }\n    const maxPage = Math.ceil(totalResult / 15);\n    const isLastPage = maxPage === page;\n    if (isLastPage) {\n      loadMoreBtn.style.display = 'none';\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        color: 'red',\n        position: 'topRight',\n      });\n    } else {\n      loadMoreBtn.style.display = 'block';\n    }\n  }\n  loadMoreBtn.addEventListener('click', loadMoreImages);\n\n  function imgTemplate({\n    webformatURL,\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  }) {\n    return `\n  <a href=\"${largeImageURL}\" class=\"${GALLERY_LINK} id=\"gallery-link\">\n     <figure>\n      <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-image\">\n      <figcaption class=\"gallery__figcaption\">\n        <p class=\"image-item\">Likes <span class=\"image-caption\">${likes}</span></p>\n        <p class=\"image-item\">Views <span class=\"image-caption\">${views}</span></p>\n        <p class=\"image-item\">Comments <span class=\"image-caption\">${comments}</span></p>\n        <p class=\"image-item\">Downloads <span class=\"image-caption\">${downloads}</span></p>\n  </figcaption>\n  </figure>\n</a>`;\n  }\n\n  function imgsTemplate(imgs) {\n    return imgs.map(imgTemplate).join('');\n  }\n\n  function renderImgs(images) {\n    if (images.length === 0) {\n      iziToast.show({\n        icon: 'icon-close',\n        messageSize: '16px',\n        backgroundColor: `red`,\n        position: 'topRight',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      loadMoreBtn.style.display = 'none';\n      galleryMarkup.innerHTML = '';\n      return;\n    }\n    const markup = imgsTemplate(images);\n    try {\n      galleryMarkup.insertAdjacentHTML('beforeend', markup);\n      totalResult += images.length;\n    } finally {\n      loader.style.display = 'none';\n    }\n  }\n\n  async function loadMoreImages() {\n    page++;\n    loader.style.display = 'block';\n    try {\n      const data = await getImage(query, page);\n      renderImgs(data.hits);\n      checkBtnStatus();\n      const imageElements = document.querySelectorAll('.gallery-link');\n      const imageHeight =\n        imageElements.length > 0 ? imageElements[0].offsetHeight : 0;\n      const scrollHeight = imageHeight * 2;\n      window.scrollBy({\n        behavior: 'smooth',\n        top: scrollHeight,\n      });\n    } catch (error) {\n      onError(`Error fetching more images: ${error}`);\n    } finally {\n      loader.style.display = 'none';\n    }\n  }\n  function onSuccess(message) {\n    iziToast.show({\n      message,\n      backgroundColor: '#EF4040',\n      progressBarColor: '#FFE0AC',\n      icon: 'icon-close',\n      ...toastOptions,\n    });\n  }\n\n  function onError(message) {\n    iziToast.show({\n      message,\n      backgroundColor: '#59A10D',\n      progressBarColor: '#B5EA7C',\n      icon: 'icon-check',\n      ...toastOptions,\n    });\n  }\n});\n"],"names":["searchForm","galleryMarkup","submitBtn","loader","GALLERY_LINK","loadMoreBtn","gallery","page","query","totalResult","data","getImage","renderImgs","checkBtnStatus","SimpleLightbox","error","onError","BASE_URL","Params","url","response","axios","iziToast","loadMoreImages","imgTemplate","webformatURL","largeImageURL","tags","likes","views","comments","downloads","imgsTemplate","imgs","images","markup","imageElements","scrollHeight","message"],"mappings":"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"}